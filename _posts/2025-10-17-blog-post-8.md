---
title: 'Flexible Isosurface Extraction for Gradient-Based Mesh Optimization'
date: 2025-10-17
permalink: /posts/2025/10/blog-post-8/
tags:

---

Flexible Isosurface Extraction for Gradient-Based Mesh Optimization
======

## Matching Cube

$$
u_{e} = \frac{x_{a}s(x_b)-x_{b}s(x_a)}{s(x_b)-s(x_a)}
$$

这是定义域在一条边上的势函数
希望找到交点 $u_{e} = 0$
进一步寻找mesh顶点

$$
v_{d} = \underset{v_d}{argmin} \sum_{u_e\in \mathbf{Z_{e}}}\triangledown s(u_e) · (v_d-u_e)
$$

通常情况下可以通过有限元差分来计算梯度

## Flexible Dual Vertex Positioning

将势函数的定义域扩大

$$
u_{e} = \frac{x_{j}\alpha_i s(x_i)-x_{i}\alpha_j s(x_j)}{s(x_i)\alpha_i-s(x_j)\alpha_j}
$$

获得12条边的 $u_{e}$ 值

然后

$$
v_d = \frac{\sum_{u_e\in V-{E}\beta_e u_e}}{\sum_{u_e\in V_E \beta_e}}
$$

找到网格顶点

因此增加了参数

$\bold{\alpha} \in \R^8$
$\bold{\beta} \in \R^{12}$

实现细节

```python
ue_group = self._linear_interp(s_group * alpha_group, x_group)
```

$\alpha$调整交点位置

```python
vd = vd.index_add_(0, index=edge_group_to_vd, source=ue_group * beta_group) / beta_sum
```

$\beta$调整网格顶点位置

```python
quad_gamma = torch.index_select(input=vd_gamma, index=quad_vd_idx.reshape(-1), dim=0).reshape(-1, 4)
gamma_02 = quad_gamma[:, 0] * quad_gamma[:, 2]
gamma_13 = quad_gamma[:, 1] * quad_gamma[:, 3]

if not training:
    mask = (gamma_02 > gamma_13)
    faces[mask] = quad_vd_idx[mask][:, self.quad_split_1]
    faces[~mask] = quad_vd_idx[~mask][:, self.quad_split_2]
```

每个 quad 有 4 个顶点 通过 $\gamma$ 控制分割的偏好 0-2 对角 vs 1-3 对角。

gamma_02 > gamma_13 选择对角线作为三角形分割。

$\gamma$ 控制 面片的拓扑和朝向 保证 mesh 拓扑连续且可微。
